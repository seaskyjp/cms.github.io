"use strict";(self.webpackChunkseaskyCMS=self.webpackChunkseaskyCMS||[]).push([[586],{2586:(G,N,i)=>{i.r(N),i.d(N,{EditShowcaseModule:()=>V});var z=i(4755),t=i(1195),C=i(5861),c=i(5030),H=i(7489),U=i(9751),u=i(2340),n=i(2223),h=i(131),B=i(3272),T=i(8397),Z=i(1401),F=i(2242),J=i(4247),M=i(4839),Q=i(6681),L=i(1929),_=i(4701),w=i(2701),R=i(3068),y=i(2839),x=i(8942),Y=i(3355);function b(l,g){if(1&l&&(n.TgZ(0,"label",24),n._uU(1),n.qZA()),2&l){const a=g.$implicit;n.Q6J("nzValue",a.id),n.xp6(1),n.Oqu(a.name)}}function X(l,g){if(1&l&&(n.ynx(0),n._UZ(1,"span",25),n.TgZ(2,"div",26),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&l){const a=n.oxw();n.xp6(1),n.Q6J("nzType",a.loading?"loading":"plus")}}function $(l,g){if(1&l&&n._UZ(0,"img",27),2&l){const a=n.oxw();n.Q6J("src",a.avatarUrl,n.LSH)}}function s(l,g){if(1&l&&(n.ynx(0),n._UZ(1,"span",25),n.TgZ(2,"div",26),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&l){const a=n.oxw();n.xp6(1),n.Q6J("nzType",a.isImgLoading?"loading":"plus")}}function d(l,g){if(1&l&&n._UZ(0,"img",27),2&l){const a=n.oxw();n.Q6J("src",a.form.value.img,n.LSH)}}const e=function(){return[".png",".jpg"]},v=[{path:"",component:(()=>{class l{constructor(a,o,p,m,E){this.router=a,this.route=o,this.supabase=p,this.message=m,this.fb=E,this.id="",this.isLoading=!1,this.isImgLoading=!1,this.cat=0,this.tags=[],this.loading=!1,this.details="",this.transformFile=O=>new U.y(P=>{const A=new FileReader;A.readAsDataURL(O),this.uploadImages(O),A.onload=()=>{const I=document.createElement("canvas"),S=document.createElement("img");S.src=A.result,S.onload=()=>{const f=I.getContext("2d");f.drawImage(S,0,0),f.fillStyle="red",f.textBaseline="middle",f.fillText("Ant Design",20,20),I.toBlob(W=>{P.next(W),P.complete()})}}}),this.transformFileSec=O=>new U.y(P=>{const A=new FileReader;A.readAsDataURL(O),this.uploadImagesSec(O),A.onload=()=>{const I=document.createElement("canvas"),S=document.createElement("img");S.src=A.result,S.onload=()=>{const f=I.getContext("2d");f.drawImage(S,0,0),f.fillStyle="red",f.textBaseline="middle",f.fillText("Ant Design",20,20),I.toBlob(W=>{P.next(W),P.complete()})}}})}ngOnInit(){this.getCate(),this.id=this.route.snapshot.params.id||"",this.form=this.fb.group({id:[null],cat:[null],created_at:[null],updated_at:[null],title:[null,[c.kI.required]],desc:[null,[c.kI.required]],details:[null],img:[null,[c.kI.required]]}),this.id&&this.getDetails(+this.id)}getDetails(a){var o=this;return(0,C.Z)(function*(){o.isLoading=!0;const{data:p,error:m}=yield o.supabase.get("showcase",a,!0);m&&o.message.error(m.message),console.log(p),o.form.setValue({...p}),o.cat=p.cat,o.details=p.details,o.isLoading=!1})()}goBack(){this.router.navigateByUrl("showcase")}submitForm(){var a=this;return(0,C.Z)(function*(){if(a.form.valid){console.log(a.form.value),a.form.value.details=a.details;const{error:o}=yield a.supabase.upsert("showcase",a.form.value);o?a.message.error(o.message):(a.message.success("Success"),a.goBack())}else Object.values(a.form.controls).forEach(o=>{o.invalid&&(o.markAsDirty(),o.updateValueAndValidity({onlySelf:!0}))})})()}getCate(){var a=this;return(0,C.Z)(function*(){a.isLoading=!0;const{data:o,error:p}=yield a.supabase.get("showcase_cat");p&&a.message.error(p.message),a.tags=H.sortBy(o,["created_at"])||[],a.isLoading=!1})()}uploadImages(a){var o=this;return(0,C.Z)(function*(){const p=a.name.split(".").pop(),m=`${Math.random()}.${p}`;o.isImgLoading=!0;const{error:E}=yield o.supabase.uploadImages(m,a);E&&o.message.error(E.message),o.form.value.img=`${u.N.storageUrl}${m}`,o.form.setValue({...o.form.value}),o.isImgLoading=!1})()}uploadImagesSec(a){var o=this;return(0,C.Z)(function*(){const p=a.name.split(".").pop(),m=`${Math.random()}.${p}`;o.loading=!0;const{error:E}=yield o.supabase.uploadImages(m,a);E&&o.message.error(E.message),o.avatarUrl=`${u.N.storageUrl}${m}`,o.loading=!1})()}}return l.\u0275fac=function(a){return new(a||l)(n.Y36(t.F0),n.Y36(t.gz),n.Y36(h.T),n.Y36(B.dD),n.Y36(c.QS))},l.\u0275cmp=n.Xpm({type:l,selectors:[["app-edit-showcase"]],decls:44,vars:38,consts:[[3,"nzSpinning"],[1,"header-wrap"],[1,"header-title"],["nz-button","","nzType","primary",1,"header-button",3,"click"],[1,"content-wrap"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","cat",3,"nzSm","nzXs"],["formControlName","cat","nzButtonStyle","solid",3,"ngModel","ngModelChange"],["nz-radio-button","",3,"nzValue",4,"ngFor","ngForOf"],["nzRequired","","nzFor","title",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","","formControlName","title","id","title"],["nzRequired","","nzFor","desc",3,"nzSm","nzXs"],["nz-input","","formControlName","desc","id","desc"],["nzRequired","","nzFor","details",3,"nzSm","nzXs"],["nzHeader","\u5c55\u958b\u3057\u307e\u3059","nzActive","false"],["nzListType","picture-card",1,"uploader",3,"nzShowUploadList","nzAccept","nzTransformFile"],[4,"ngIf"],["style","width: 100%",3,"src",4,"ngIf"],[2,"line-height","1.5 !important",3,"content","contentChange"],["nzRequired","","nzFor","img",3,"nzSm","nzXs"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"nzLoading"],["nz-radio-button","",3,"nzValue"],["nz-icon","",1,"upload-icon",3,"nzType"],[1,"ant-upload-text"],[2,"width","100%",3,"src"]],template:function(a,o){1&a&&(n.TgZ(0,"nz-spin",0)(1,"div",1),n._UZ(2,"div",2),n.TgZ(3,"button",3),n.NdJ("click",function(){return o.goBack()}),n._uU(4,"\u623b\u3063\u3066"),n.qZA()(),n._UZ(5,"nz-divider"),n.TgZ(6,"div",4)(7,"form",5),n.NdJ("ngSubmit",function(){return o.submitForm()}),n.TgZ(8,"nz-form-item")(9,"nz-form-label",6),n._uU(10,"Category"),n.qZA(),n.TgZ(11,"nz-radio-group",7),n.NdJ("ngModelChange",function(m){return o.cat=m}),n.YNc(12,b,2,2,"label",8),n.qZA()(),n.TgZ(13,"nz-form-item")(14,"nz-form-label",9),n._uU(15,"Title"),n.qZA(),n.TgZ(16,"nz-form-control",10),n._UZ(17,"input",11),n.qZA()(),n.TgZ(18,"nz-form-item")(19,"nz-form-label",12),n._uU(20,"Description"),n.qZA(),n.TgZ(21,"nz-form-control",10),n._UZ(22,"input",13),n.qZA()(),n.TgZ(23,"nz-form-item")(24,"nz-form-label",14),n._uU(25,"Details"),n.qZA(),n.TgZ(26,"nz-form-control",10)(27,"nz-collapse")(28,"nz-collapse-panel",15)(29,"nz-upload",16),n.YNc(30,X,4,1,"ng-container",17),n.YNc(31,$,1,1,"img",18),n.qZA(),n.TgZ(32,"app-content-editor",19),n.NdJ("contentChange",function(m){return o.details=m}),n.qZA()()()()(),n.TgZ(33,"nz-form-item")(34,"nz-form-label",20),n._uU(35,"Image"),n.qZA(),n.TgZ(36,"nz-form-control",10)(37,"nz-upload",16),n.YNc(38,s,4,1,"ng-container",17),n.YNc(39,d,1,1,"img",18),n.qZA()()(),n.TgZ(40,"nz-form-item",21)(41,"nz-form-control",22)(42,"button",23),n._uU(43,"\u4fdd\u5b58"),n.qZA()()()()()()),2&a&&(n.Q6J("nzSpinning",o.isLoading),n.xp6(7),n.Q6J("formGroup",o.form),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("ngModel",o.cat),n.xp6(1),n.Q6J("ngForOf",o.tags),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzShowUploadList",!1)("nzAccept",n.DdM(36,e))("nzTransformFile",o.transformFileSec),n.xp6(1),n.Q6J("ngIf",!o.avatarUrl),n.xp6(1),n.Q6J("ngIf",o.avatarUrl),n.xp6(1),n.Q6J("content",o.details),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzShowUploadList",!1)("nzAccept",n.DdM(37,e))("nzTransformFile",o.transformFile),n.xp6(1),n.Q6J("ngIf",!o.form.value.img),n.xp6(1),n.Q6J("ngIf",o.form.value.img),n.xp6(2),n.Q6J("nzSpan",14)("nzOffset",6),n.xp6(1),n.Q6J("nzLoading",o.isLoading||o.isImgLoading))},dependencies:[z.sg,z.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,T.Zp,Z.ix,F.w,J.dQ,M.g,Q.W,L.t3,L.SK,_.Lr,_.Nx,_.iK,_.Fd,w.Ls,R.FY,y.Of,y.Bq,y.Dg,x.Zv,x.yH,Y.F]}),l})()}];let D=(()=>{class l{}return l.\u0275fac=function(a){return new(a||l)},l.\u0275mod=n.oAB({type:l}),l.\u0275inj=n.cJS({imports:[t.Bz.forChild(v),t.Bz]}),l})();var K=i(3174),j=i(4233);let V=(()=>{class l{}return l.\u0275fac=function(a){return new(a||l)},l.\u0275mod=n.oAB({type:l}),l.\u0275inj=n.cJS({imports:[z.ez,D,c.UX,T.o7,Z.sL,M.S,K.HQ,Q.j,_.U5,w.PV,R.cS,y.aF,c.u5,x.cD,j.m]}),l})()},8942:(G,N,i)=>{i.d(N,{Zv:()=>X,cD:()=>$,yH:()=>Y});var z=i(7582),t=i(2223),C=i(4968),c=i(2722),H=i(9300),U=i(7169),u=i(9436),n=i(8982),h=i(4780),B=i(8930),T=i(6760),Z=i(4755),F=i(2701),J=i(2643);const M=["*"],Q=["collapseHeader"];function L(s,d){if(1&s&&(t.ynx(0),t._UZ(1,"span",7),t.BQk()),2&s){const e=d.$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("nzType",e||"right")("nzRotate",r.nzActive?90:0)}}function _(s,d){if(1&s&&(t.TgZ(0,"div"),t.YNc(1,L,2,2,"ng-container",3),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzExpandedIcon)}}function w(s,d){if(1&s&&(t.ynx(0),t._uU(1),t.BQk()),2&s){const e=t.oxw();t.xp6(1),t.Oqu(e.nzHeader)}}function R(s,d){if(1&s&&(t.ynx(0),t._uU(1),t.BQk()),2&s){const e=t.oxw(2);t.xp6(1),t.Oqu(e.nzExtra)}}function y(s,d){if(1&s&&(t.TgZ(0,"div",8),t.YNc(1,R,2,1,"ng-container",3),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzExtra)}}const x="collapse";let Y=(()=>{class s{constructor(e,r,v,D){this.nzConfigService=e,this.cdr=r,this.directionality=v,this.destroy$=D,this._nzModuleName=x,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(x).pipe((0,c.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,c.R)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(e){this.listOfNzCollapsePanelComponent.push(e)}removePanel(e){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(e),1)}click(e){this.nzAccordion&&!e.nzActive&&this.listOfNzCollapsePanelComponent.filter(r=>r!==e).forEach(r=>{r.nzActive&&(r.nzActive=!1,r.nzActiveChange.emit(r.nzActive),r.markForCheck())}),e.nzActive=!e.nzActive,e.nzActiveChange.emit(e.nzActive)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(u.jY),t.Y36(t.sBO),t.Y36(B.Is,8),t.Y36(n.kn))},s.\u0275cmp=t.Xpm({type:s,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(e,r){2&e&&t.ekj("ant-collapse-icon-position-left","left"===r.nzExpandIconPosition)("ant-collapse-icon-position-right","right"===r.nzExpandIconPosition)("ant-collapse-ghost",r.nzGhost)("ant-collapse-borderless",!r.nzBordered)("ant-collapse-rtl","rtl"===r.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],features:[t._Bn([n.kn])],ngContentSelectors:M,decls:1,vars:0,template:function(e,r){1&e&&(t.F$t(),t.Hsn(0))},encapsulation:2,changeDetection:0}),(0,z.gn)([(0,u.oS)(),(0,h.yF)()],s.prototype,"nzAccordion",void 0),(0,z.gn)([(0,u.oS)(),(0,h.yF)()],s.prototype,"nzBordered",void 0),(0,z.gn)([(0,u.oS)(),(0,h.yF)()],s.prototype,"nzGhost",void 0),s})();const b="collapsePanel";let X=(()=>{class s{markForCheck(){this.cdr.markForCheck()}constructor(e,r,v,D,K,j){this.nzConfigService=e,this.ngZone=r,this.cdr=v,this.destroy$=D,this.nzCollapseComponent=K,this.noAnimation=j,this._nzModuleName=b,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new t.vpe,this.nzConfigService.getConfigChangeEventForComponent(b).pipe((0,c.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.nzCollapseComponent.addPanel(this),this.ngZone.runOutsideAngular(()=>(0,C.R)(this.collapseHeader.nativeElement,"click").pipe((0,H.h)(()=>!this.nzDisabled),(0,c.R)(this.destroy$)).subscribe(()=>{this.ngZone.run(()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()})}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(u.jY),t.Y36(t.R0b),t.Y36(t.sBO),t.Y36(n.kn),t.Y36(Y,1),t.Y36(T.P,8))},s.\u0275cmp=t.Xpm({type:s,selectors:[["nz-collapse-panel"]],viewQuery:function(e,r){if(1&e&&t.Gf(Q,7),2&e){let v;t.iGM(v=t.CRH())&&(r.collapseHeader=v.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function(e,r){2&e&&t.ekj("ant-collapse-no-arrow",!r.nzShowArrow)("ant-collapse-item-active",r.nzActive)("ant-collapse-item-disabled",r.nzDisabled)},inputs:{nzActive:"nzActive",nzDisabled:"nzDisabled",nzShowArrow:"nzShowArrow",nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],features:[t._Bn([n.kn])],ngContentSelectors:M,decls:8,vars:8,consts:[["role","button",1,"ant-collapse-header"],["collapseHeader",""],[4,"ngIf"],[4,"nzStringTemplateOutlet"],["class","ant-collapse-extra",4,"ngIf"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"],[1,"ant-collapse-extra"]],template:function(e,r){1&e&&(t.F$t(),t.TgZ(0,"div",0,1),t.YNc(2,_,2,1,"div",2),t.YNc(3,w,2,1,"ng-container",3),t.YNc(4,y,2,1,"div",4),t.qZA(),t.TgZ(5,"div",5)(6,"div",6),t.Hsn(7),t.qZA()()),2&e&&(t.uIk("aria-expanded",r.nzActive),t.xp6(2),t.Q6J("ngIf",r.nzShowArrow),t.xp6(1),t.Q6J("nzStringTemplateOutlet",r.nzHeader),t.xp6(1),t.Q6J("ngIf",r.nzExtra),t.xp6(1),t.ekj("ant-collapse-content-active",r.nzActive),t.Q6J("@.disabled",!(null==r.noAnimation||!r.noAnimation.nzNoAnimation))("@collapseMotion",r.nzActive?"expanded":"hidden"))},dependencies:[Z.O5,F.Ls,J.f],encapsulation:2,data:{animation:[U.J_]},changeDetection:0}),(0,z.gn)([(0,h.yF)()],s.prototype,"nzActive",void 0),(0,z.gn)([(0,h.yF)()],s.prototype,"nzDisabled",void 0),(0,z.gn)([(0,u.oS)(),(0,h.yF)()],s.prototype,"nzShowArrow",void 0),s})(),$=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[B.vT,Z.ez,F.PV,J.T,T.g]}),s})()}}]);