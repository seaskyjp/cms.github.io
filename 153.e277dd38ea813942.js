"use strict";(self.webpackChunkseaskyCMS=self.webpackChunkseaskyCMS||[]).push([[153],{6153:(Y,p,i)=>{i.r(p),i.d(p,{EditHomenewModule:()=>N});var v=i(4755),d=i(1195),z=i(5861),r=i(5030),E=i(9751),A=i(2340),n=i(2223),C=i(131),F=i(3272),h=i(8397),S=i(1401),I=i(2242),H=i(4247),Z=i(4839),T=i(6681),y=i(1929),l=i(4701),J=i(2701),x=i(3068);function w(e,s){if(1&e&&(n.ynx(0),n._UZ(1,"span",20),n.TgZ(2,"div",21),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&e){const o=n.oxw();n.xp6(1),n.Q6J("nzType",o.isImgLoading?"loading":"plus")}}function X(e,s){if(1&e&&n._UZ(0,"img",22),2&e){const o=n.oxw();n.Q6J("src",o.form.value.img,n.LSH)}}const b=function(){return[".png",".jpg"]},B=[{path:"",component:(()=>{class e{constructor(o,t,a,m,u){this.router=o,this.route=t,this.supabase=a,this.message=m,this.fb=u,this.id="",this.isLoading=!1,this.isImgLoading=!1,this.transformFile=U=>new E.y(L=>{const f=new FileReader;f.readAsDataURL(U),this.uploadImages(U),f.onload=()=>{const Q=document.createElement("canvas"),c=document.createElement("img");c.src=f.result,c.onload=()=>{const g=Q.getContext("2d");g.drawImage(c,0,0),g.fillStyle="red",g.textBaseline="middle",g.fillText("Ant Design",20,20),Q.toBlob(R=>{L.next(R),L.complete()})}}})}ngOnInit(){this.id=this.route.snapshot.params.id||"",this.form=this.fb.group({id:[null],created_at:[null],updated_at:[null],title:[null,[r.kI.required]],subTitle:[null,[r.kI.required]],content:[null,[r.kI.required]],img:[null,[r.kI.required]]}),this.id&&this.getDetails(+this.id)}getDetails(o){var t=this;return(0,z.Z)(function*(){t.isLoading=!0;const{data:a,error:m}=yield t.supabase.get("home2",o,!0);m&&t.message.error(m.message),console.log(a),t.form.setValue({...a}),t.isLoading=!1})()}goBack(){this.router.navigateByUrl("home-new")}submitForm(){var o=this;return(0,z.Z)(function*(){if(o.form.valid){console.log(o.form.value);const{error:t}=yield o.supabase.upsert("home2",o.form.value);t?o.message.error(t.message):(o.message.success("Success"),o.goBack())}else Object.values(o.form.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})})()}uploadImages(o){var t=this;return(0,z.Z)(function*(){const a=o.name.split(".").pop(),m=`${Math.random()}.${a}`;t.isImgLoading=!0;const{error:u}=yield t.supabase.uploadImages(m,o);u&&t.message.error(u.message),t.form.value.img=`${A.N.storageUrl}${m}`,t.form.setValue({...t.form.value}),t.isImgLoading=!1})()}}return e.\u0275fac=function(o){return new(o||e)(n.Y36(d.F0),n.Y36(d.gz),n.Y36(C.T),n.Y36(F.dD),n.Y36(r.QS))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-edit-homenew"]],decls:34,vars:27,consts:[[3,"nzSpinning"],[1,"header-wrap"],[1,"header-title"],["nz-button","","nzType","primary",1,"header-button",3,"click"],[1,"content-wrap"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","title",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","","formControlName","title","id","title"],["nzRequired","","nzFor","subTitle",3,"nzSm","nzXs"],["nz-input","","formControlName","subTitle","id","subTitle"],["nzRequired","","nzFor","content",3,"nzSm","nzXs"],["nz-input","","formControlName","content","id","content"],["nzRequired","","nzFor","img",3,"nzSm","nzXs"],["nzListType","picture-card",1,"uploader",3,"nzShowUploadList","nzAccept","nzTransformFile"],[4,"ngIf"],["style","width: 100%",3,"src",4,"ngIf"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"nzLoading"],["nz-icon","",1,"upload-icon",3,"nzType"],[1,"ant-upload-text"],[2,"width","100%",3,"src"]],template:function(o,t){1&o&&(n.TgZ(0,"nz-spin",0)(1,"div",1),n._UZ(2,"div",2),n.TgZ(3,"button",3),n.NdJ("click",function(){return t.goBack()}),n._uU(4,"\u623b\u3063\u3066"),n.qZA()(),n._UZ(5,"nz-divider"),n.TgZ(6,"div",4)(7,"form",5),n.NdJ("ngSubmit",function(){return t.submitForm()}),n.TgZ(8,"nz-form-item")(9,"nz-form-label",6),n._uU(10,"Title"),n.qZA(),n.TgZ(11,"nz-form-control",7),n._UZ(12,"input",8),n.qZA()(),n.TgZ(13,"nz-form-item")(14,"nz-form-label",9),n._uU(15,"Sub Title"),n.qZA(),n.TgZ(16,"nz-form-control",7),n._UZ(17,"input",10),n.qZA()(),n.TgZ(18,"nz-form-item")(19,"nz-form-label",11),n._uU(20,"Content"),n.qZA(),n.TgZ(21,"nz-form-control",7),n._UZ(22,"input",12),n.qZA()(),n.TgZ(23,"nz-form-item")(24,"nz-form-label",13),n._uU(25,"Image"),n.qZA(),n.TgZ(26,"nz-form-control",7)(27,"nz-upload",14),n.YNc(28,w,4,1,"ng-container",15),n.YNc(29,X,1,1,"img",16),n.qZA()()(),n.TgZ(30,"nz-form-item",17)(31,"nz-form-control",18)(32,"button",19),n._uU(33,"\u4fdd\u5b58"),n.qZA()()()()()()),2&o&&(n.Q6J("nzSpinning",t.isLoading),n.xp6(7),n.Q6J("formGroup",t.form),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzShowUploadList",!1)("nzAccept",n.DdM(26,b))("nzTransformFile",t.transformFile),n.xp6(1),n.Q6J("ngIf",!t.form.value.img),n.xp6(1),n.Q6J("ngIf",t.form.value.img),n.xp6(2),n.Q6J("nzSpan",14)("nzOffset",6),n.xp6(1),n.Q6J("nzLoading",t.isLoading||t.isImgLoading))},dependencies:[v.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,h.Zp,S.ix,I.w,H.dQ,Z.g,T.W,y.t3,y.SK,l.Lr,l.Nx,l.iK,l.Fd,J.Ls,x.FY]}),e})()}];let M=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[d.Bz.forChild(B),d.Bz]}),e})();var D=i(3174);let N=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[v.ez,M,r.UX,h.o7,S.sL,Z.S,D.HQ,T.j,l.U5,J.PV,x.cS]}),e})()}}]);