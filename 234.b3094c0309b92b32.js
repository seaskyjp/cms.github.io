"use strict";(self.webpackChunkseaskyCMS=self.webpackChunkseaskyCMS||[]).push([[234],{4234:(G,x,o)=>{o.r(x),o.d(x,{EditMessageModule:()=>T});var m=o(4755),t=o(1195),C=o(5861),d=o(5030),L=o(9751),J=o(2340),n=o(2223),v=o(131),u=o(3272),_=o(8397),E=o(1401),D=o(2242),P=o(4247),A=o(4839),M=o(6681),O=o(1929),h=o(4701),I=o(2701),S=o(3068),y=o(8942),Q=o(3355);function Z(l,g){if(1&l){const r=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){n.CHM(r);const p=n.oxw();return n.KtG(p.edit())}),n._uU(1,"\u7de8\u96c6"),n.qZA()}}function N(l,g){if(1&l){const r=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){n.CHM(r);const p=n.oxw();return n.KtG(p.cancel())}),n._uU(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),n.qZA()}}function F(l,g){if(1&l&&(n.ynx(0),n._UZ(1,"span",22),n.TgZ(2,"div",23),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&l){const r=n.oxw();n.xp6(1),n.Q6J("nzType",r.isImgLoading?"loading":"plus")}}function R(l,g){if(1&l&&n._UZ(0,"img",24),2&l){const r=n.oxw();n.Q6J("src",r.form.value.img,n.LSH)}}const b=function(){return[".png",".jpg"]},c=[{path:"",component:(()=>{class l{constructor(r,s,p,z,B){this.router=r,this.route=s,this.supabase=p,this.message=z,this.fb=B,this.id="",this.isLoading=!1,this.isImgLoading=!1,this.isEdit=!1,this.content="",this.transformFile=K=>new L.y(j=>{const Y=new FileReader;Y.readAsDataURL(K),this.uploadImages(K),Y.onload=()=>{const W=document.createElement("canvas"),H=document.createElement("img");H.src=Y.result,H.onload=()=>{const U=W.getContext("2d");U.drawImage(H,0,0),U.fillStyle="red",U.textBaseline="middle",U.fillText("Ant Design",20,20),W.toBlob(X=>{j.next(X),j.complete()})}}})}ngOnInit(){this.id="1",this.form=this.fb.group({id:[null],created_at:[null],updated_at:[null],content:[null],ceo:[null,[d.kI.required]],img:[null,[d.kI.required]]}),this.cancel(),this.id&&this.getDetails(+this.id)}getDetails(r){var s=this;return(0,C.Z)(function*(){s.isLoading=!0;const{data:p,error:z}=yield s.supabase.get("message",r,!0);z&&s.message.error(z.message),console.log(p),s.content=p.content,s.form.setValue({...p}),s.isLoading=!1})()}onChange(r){console.log("onChange: ",r)}submitForm(){var r=this;return(0,C.Z)(function*(){if(r.form.valid){r.form.value.content=r.content,console.log(r.form.value);const{error:s}=yield r.supabase.upsert("message",r.form.value);s?r.message.error(s.message):(r.message.success("Success"),r.cancel())}else Object.values(r.form.controls).forEach(s=>{s.invalid&&(s.markAsDirty(),s.updateValueAndValidity({onlySelf:!0}))})})()}edit(){this.isEdit=!0,this.form.controls.ceo.enable()}cancel(){this.isEdit=!1,this.form.controls.ceo.disable()}uploadImages(r){var s=this;return(0,C.Z)(function*(){const p=r.name.split(".").pop(),z=`${Math.random()}.${p}`;s.isImgLoading=!0;const{error:B}=yield s.supabase.uploadImages(z,r);B&&s.message.error(B.message),s.form.value.img=`${J.N.storageUrl}${z}`,s.form.setValue({...s.form.value}),s.isImgLoading=!1})()}}return l.\u0275fac=function(r){return new(r||l)(n.Y36(t.F0),n.Y36(t.gz),n.Y36(v.T),n.Y36(u.dD),n.Y36(d.QS))},l.\u0275cmp=n.Xpm({type:l,selectors:[["app-edit-message"]],decls:33,vars:29,consts:[["nzHeader","\u4f8b","nzActive","false"],["src","assets/img/message.png",2,"width","100%","height","auto"],["nzHeader","\u30c7\u30fc\u30bf","nzActive","true"],[3,"nzSpinning"],[1,"header-wrap"],[1,"header-title"],["class","header-button","nz-button","","nzType","primary",3,"click",4,"ngIf"],[1,"content-wrap"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","content",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],[2,"line-height","1.5 !important",3,"content","readonlyflag","contentChange"],["nzRequired","","nzFor","ceo",3,"nzSm","nzXs"],["nz-input","","formControlName","ceo","id","ceo"],["nzRequired","","nzFor","img",3,"nzSm","nzXs"],["nzListType","picture-card",1,"uploader",3,"nzDisabled","nzShowUploadList","nzAccept","nzTransformFile"],[4,"ngIf"],["style","width: 100%",3,"src",4,"ngIf"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled","nzLoading"],["nz-button","","nzType","primary",1,"header-button",3,"click"],["nz-icon","",1,"upload-icon",3,"nzType"],[1,"ant-upload-text"],[2,"width","100%",3,"src"]],template:function(r,s){1&r&&(n.TgZ(0,"nz-collapse")(1,"nz-collapse-panel",0),n._UZ(2,"img",1),n.qZA(),n.TgZ(3,"nz-collapse-panel",2)(4,"nz-spin",3)(5,"div",4),n._UZ(6,"div",5),n.YNc(7,Z,2,0,"button",6),n.YNc(8,N,2,0,"button",6),n.qZA(),n._UZ(9,"nz-divider"),n.TgZ(10,"div",7)(11,"form",8),n.NdJ("ngSubmit",function(){return s.submitForm()}),n.TgZ(12,"nz-form-item")(13,"nz-form-label",9),n._uU(14,"Content"),n.qZA(),n.TgZ(15,"nz-form-control",10)(16,"app-content-editor",11),n.NdJ("contentChange",function(z){return s.content=z}),n.qZA()()(),n.TgZ(17,"nz-form-item")(18,"nz-form-label",12),n._uU(19,"CEO"),n.qZA(),n.TgZ(20,"nz-form-control",10),n._UZ(21,"input",13),n.qZA()(),n.TgZ(22,"nz-form-item")(23,"nz-form-label",14),n._uU(24,"Image"),n.qZA(),n.TgZ(25,"nz-form-control",10)(26,"nz-upload",15),n.YNc(27,F,4,1,"ng-container",16),n.YNc(28,R,1,1,"img",17),n.qZA()()(),n.TgZ(29,"nz-form-item",18)(30,"nz-form-control",19)(31,"button",20),n._uU(32,"\u4fdd\u5b58"),n.qZA()()()()()()()()),2&r&&(n.xp6(4),n.Q6J("nzSpinning",s.isLoading),n.xp6(3),n.Q6J("ngIf",!s.isEdit),n.xp6(1),n.Q6J("ngIf",s.isEdit),n.xp6(3),n.Q6J("formGroup",s.form),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("content",s.content)("readonlyflag",!s.isEdit),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzDisabled",!s.isEdit)("nzShowUploadList",!1)("nzAccept",n.DdM(28,b))("nzTransformFile",s.transformFile),n.xp6(1),n.Q6J("ngIf",!s.form.value.img),n.xp6(1),n.Q6J("ngIf",s.form.value.img),n.xp6(2),n.Q6J("nzSpan",6)("nzOffset",6),n.xp6(1),n.Q6J("disabled",!s.isEdit)("nzLoading",s.isLoading||s.isImgLoading))},dependencies:[m.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,_.Zp,E.ix,D.w,P.dQ,A.g,M.W,O.t3,O.SK,h.Lr,h.Nx,h.iK,h.Fd,I.Ls,S.FY,y.Zv,y.yH,Q.F]}),l})()}];let e=(()=>{class l{}return l.\u0275fac=function(r){return new(r||l)},l.\u0275mod=n.oAB({type:l}),l.\u0275inj=n.cJS({imports:[t.Bz.forChild(c),t.Bz]}),l})();var a=o(3174),f=o(4233);let T=(()=>{class l{}return l.\u0275fac=function(r){return new(r||l)},l.\u0275mod=n.oAB({type:l}),l.\u0275inj=n.cJS({imports:[m.ez,e,d.UX,_.o7,E.sL,A.S,a.HQ,M.j,h.U5,I.PV,S.cS,d.u5,y.cD,f.m]}),l})()},8942:(G,x,o)=>{o.d(x,{Zv:()=>R,cD:()=>b,yH:()=>N});var m=o(7582),t=o(2223),C=o(4968),d=o(2722),L=o(9300),J=o(7169),n=o(9436),v=o(8982),u=o(4780),_=o(8930),E=o(6760),D=o(4755),P=o(2701),A=o(2643);const M=["*"],O=["collapseHeader"];function h(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"span",7),t.BQk()),2&i){const e=c.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("nzType",e||"right")("nzRotate",a.nzActive?90:0)}}function I(i,c){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,h,2,2,"ng-container",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzExpandedIcon)}}function S(i,c){if(1&i&&(t.ynx(0),t._uU(1),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.nzHeader)}}function y(i,c){if(1&i&&(t.ynx(0),t._uU(1),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.nzExtra)}}function Q(i,c){if(1&i&&(t.TgZ(0,"div",8),t.YNc(1,y,2,1,"ng-container",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzExtra)}}const Z="collapse";let N=(()=>{class i{constructor(e,a,f,T){this.nzConfigService=e,this.cdr=a,this.directionality=f,this.destroy$=T,this._nzModuleName=Z,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(Z).pipe((0,d.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,d.R)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(e){this.listOfNzCollapsePanelComponent.push(e)}removePanel(e){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(e),1)}click(e){this.nzAccordion&&!e.nzActive&&this.listOfNzCollapsePanelComponent.filter(a=>a!==e).forEach(a=>{a.nzActive&&(a.nzActive=!1,a.nzActiveChange.emit(a.nzActive),a.markForCheck())}),e.nzActive=!e.nzActive,e.nzActiveChange.emit(e.nzActive)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(n.jY),t.Y36(t.sBO),t.Y36(_.Is,8),t.Y36(v.kn))},i.\u0275cmp=t.Xpm({type:i,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(e,a){2&e&&t.ekj("ant-collapse-icon-position-left","left"===a.nzExpandIconPosition)("ant-collapse-icon-position-right","right"===a.nzExpandIconPosition)("ant-collapse-ghost",a.nzGhost)("ant-collapse-borderless",!a.nzBordered)("ant-collapse-rtl","rtl"===a.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],features:[t._Bn([v.kn])],ngContentSelectors:M,decls:1,vars:0,template:function(e,a){1&e&&(t.F$t(),t.Hsn(0))},encapsulation:2,changeDetection:0}),(0,m.gn)([(0,n.oS)(),(0,u.yF)()],i.prototype,"nzAccordion",void 0),(0,m.gn)([(0,n.oS)(),(0,u.yF)()],i.prototype,"nzBordered",void 0),(0,m.gn)([(0,n.oS)(),(0,u.yF)()],i.prototype,"nzGhost",void 0),i})();const F="collapsePanel";let R=(()=>{class i{markForCheck(){this.cdr.markForCheck()}constructor(e,a,f,T,l,g){this.nzConfigService=e,this.ngZone=a,this.cdr=f,this.destroy$=T,this.nzCollapseComponent=l,this.noAnimation=g,this._nzModuleName=F,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new t.vpe,this.nzConfigService.getConfigChangeEventForComponent(F).pipe((0,d.R)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.nzCollapseComponent.addPanel(this),this.ngZone.runOutsideAngular(()=>(0,C.R)(this.collapseHeader.nativeElement,"click").pipe((0,L.h)(()=>!this.nzDisabled),(0,d.R)(this.destroy$)).subscribe(()=>{this.ngZone.run(()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()})}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(n.jY),t.Y36(t.R0b),t.Y36(t.sBO),t.Y36(v.kn),t.Y36(N,1),t.Y36(E.P,8))},i.\u0275cmp=t.Xpm({type:i,selectors:[["nz-collapse-panel"]],viewQuery:function(e,a){if(1&e&&t.Gf(O,7),2&e){let f;t.iGM(f=t.CRH())&&(a.collapseHeader=f.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function(e,a){2&e&&t.ekj("ant-collapse-no-arrow",!a.nzShowArrow)("ant-collapse-item-active",a.nzActive)("ant-collapse-item-disabled",a.nzDisabled)},inputs:{nzActive:"nzActive",nzDisabled:"nzDisabled",nzShowArrow:"nzShowArrow",nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],features:[t._Bn([v.kn])],ngContentSelectors:M,decls:8,vars:8,consts:[["role","button",1,"ant-collapse-header"],["collapseHeader",""],[4,"ngIf"],[4,"nzStringTemplateOutlet"],["class","ant-collapse-extra",4,"ngIf"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"],[1,"ant-collapse-extra"]],template:function(e,a){1&e&&(t.F$t(),t.TgZ(0,"div",0,1),t.YNc(2,I,2,1,"div",2),t.YNc(3,S,2,1,"ng-container",3),t.YNc(4,Q,2,1,"div",4),t.qZA(),t.TgZ(5,"div",5)(6,"div",6),t.Hsn(7),t.qZA()()),2&e&&(t.uIk("aria-expanded",a.nzActive),t.xp6(2),t.Q6J("ngIf",a.nzShowArrow),t.xp6(1),t.Q6J("nzStringTemplateOutlet",a.nzHeader),t.xp6(1),t.Q6J("ngIf",a.nzExtra),t.xp6(1),t.ekj("ant-collapse-content-active",a.nzActive),t.Q6J("@.disabled",!(null==a.noAnimation||!a.noAnimation.nzNoAnimation))("@collapseMotion",a.nzActive?"expanded":"hidden"))},dependencies:[D.O5,P.Ls,A.f],encapsulation:2,data:{animation:[J.J_]},changeDetection:0}),(0,m.gn)([(0,u.yF)()],i.prototype,"nzActive",void 0),(0,m.gn)([(0,u.yF)()],i.prototype,"nzDisabled",void 0),(0,m.gn)([(0,n.oS)(),(0,u.yF)()],i.prototype,"nzShowArrow",void 0),i})(),b=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[_.vT,D.ez,P.PV,A.T,E.g]}),i})()}}]);