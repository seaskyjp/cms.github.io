"use strict";(self.webpackChunkseaskyCMS=self.webpackChunkseaskyCMS||[]).push([[104],{8104:(O,p,i)=>{i.r(p),i.d(p,{EditClientModule:()=>b});var v=i(4755),r=i(5030),d=i(1195),z=i(5861),Q=i(9751),E=i(2340),n=i(2223),I=i(131),A=i(3272),h=i(8397),Z=i(1401),F=i(2242),X=i(4247),C=i(4839),S=i(6681),y=i(1929),m=i(4701),T=i(2701),J=i(3068);function B(e,s){if(1&e&&(n.ynx(0),n._UZ(1,"span",20),n.TgZ(2,"div",21),n._uU(3,"Upload"),n.qZA(),n.BQk()),2&e){const o=n.oxw();n.xp6(1),n.Q6J("nzType",o.isImgLoading?"loading":"plus")}}function M(e,s){if(1&e&&n._UZ(0,"img",22),2&e){const o=n.oxw();n.Q6J("src",o.form.value.img,n.LSH)}}const D=function(){return[".png",".jpg"]},N=[{path:"",component:(()=>{class e{constructor(o,t,a,l,u){this.router=o,this.route=t,this.supabase=a,this.message=l,this.fb=u,this.id="",this.isLoading=!1,this.isImgLoading=!1,this.transformFile=x=>new Q.y(U=>{const c=new FileReader;c.readAsDataURL(x),this.uploadImages(x),c.onload=()=>{const L=document.createElement("canvas"),f=document.createElement("img");f.src=c.result,f.onload=()=>{const g=L.getContext("2d");g.drawImage(f,0,0),g.fillStyle="red",g.textBaseline="middle",g.fillText("Ant Design",20,20),L.toBlob(j=>{U.next(j),U.complete()})}}})}ngOnInit(){this.id=this.route.snapshot.params.id||"",this.form=this.fb.group({id:[null],created_at:[null],updated_at:[null],name:[null,[r.kI.required]],industry:[null,[r.kI.required]],desc:[null,[r.kI.required]],img:[null,[r.kI.required]]}),this.id&&this.getDetails(+this.id)}getDetails(o){var t=this;return(0,z.Z)(function*(){t.isLoading=!0;const{data:a,error:l}=yield t.supabase.get("clients",o,!0);l&&t.message.error(l.message),console.log(a),t.form.setValue({...a}),t.isLoading=!1})()}goBack(){this.router.navigateByUrl("clients")}submitForm(){var o=this;return(0,z.Z)(function*(){if(o.form.valid){console.log(o.form.value);const{error:t}=yield o.supabase.upsert("clients",o.form.value);t?o.message.error(t.message):(o.message.success("Success"),o.goBack())}else Object.values(o.form.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})})()}uploadImages(o){var t=this;return(0,z.Z)(function*(){const a=o.name.split(".").pop(),l=`${Math.random()}.${a}`;t.isImgLoading=!0;const{error:u}=yield t.supabase.uploadImages(l,o);u&&t.message.error(u.message),t.form.value.img=`${E.N.storageUrl}${l}`,t.form.setValue({...t.form.value}),t.isImgLoading=!1})()}}return e.\u0275fac=function(o){return new(o||e)(n.Y36(d.F0),n.Y36(d.gz),n.Y36(I.T),n.Y36(A.dD),n.Y36(r.QS))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-edit-client"]],decls:34,vars:27,consts:[[3,"nzSpinning"],[1,"header-wrap"],[1,"header-title"],["nz-button","","nzType","primary",1,"header-button",3,"click"],[1,"content-wrap"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nz-input","","formControlName","name","id","name"],["nzRequired","","nzFor","industry",3,"nzSm","nzXs"],["nz-input","","formControlName","industry","id","industry"],["nzRequired","","nzFor","desc",3,"nzSm","nzXs"],["nz-input","","formControlName","desc","id","desc"],["nzRequired","","nzFor","img",3,"nzSm","nzXs"],["nzListType","picture-card",1,"uploader",3,"nzShowUploadList","nzAccept","nzTransformFile"],[4,"ngIf"],["style","width: 100%",3,"src",4,"ngIf"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"nzLoading"],["nz-icon","",1,"upload-icon",3,"nzType"],[1,"ant-upload-text"],[2,"width","100%",3,"src"]],template:function(o,t){1&o&&(n.TgZ(0,"nz-spin",0)(1,"div",1),n._UZ(2,"div",2),n.TgZ(3,"button",3),n.NdJ("click",function(){return t.goBack()}),n._uU(4,"\u623b\u3063\u3066"),n.qZA()(),n._UZ(5,"nz-divider"),n.TgZ(6,"div",4)(7,"form",5),n.NdJ("ngSubmit",function(){return t.submitForm()}),n.TgZ(8,"nz-form-item")(9,"nz-form-label",6),n._uU(10,"Name"),n.qZA(),n.TgZ(11,"nz-form-control",7),n._UZ(12,"input",8),n.qZA()(),n.TgZ(13,"nz-form-item")(14,"nz-form-label",9),n._uU(15,"Industry"),n.qZA(),n.TgZ(16,"nz-form-control",7),n._UZ(17,"input",10),n.qZA()(),n.TgZ(18,"nz-form-item")(19,"nz-form-label",11),n._uU(20,"Description"),n.qZA(),n.TgZ(21,"nz-form-control",7),n._UZ(22,"input",12),n.qZA()(),n.TgZ(23,"nz-form-item")(24,"nz-form-label",13),n._uU(25,"Image"),n.qZA(),n.TgZ(26,"nz-form-control",7)(27,"nz-upload",14),n.YNc(28,B,4,1,"ng-container",15),n.YNc(29,M,1,1,"img",16),n.qZA()()(),n.TgZ(30,"nz-form-item",17)(31,"nz-form-control",18)(32,"button",19),n._uU(33,"\u4fdd\u5b58"),n.qZA()()()()()()),2&o&&(n.Q6J("nzSpinning",t.isLoading),n.xp6(7),n.Q6J("formGroup",t.form),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzShowUploadList",!1)("nzAccept",n.DdM(26,D))("nzTransformFile",t.transformFile),n.xp6(1),n.Q6J("ngIf",!t.form.value.img),n.xp6(1),n.Q6J("ngIf",t.form.value.img),n.xp6(2),n.Q6J("nzSpan",14)("nzOffset",6),n.xp6(1),n.Q6J("nzLoading",t.isLoading||t.isImgLoading))},dependencies:[v.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,h.Zp,Z.ix,F.w,X.dQ,C.g,S.W,y.t3,y.SK,m.Lr,m.Nx,m.iK,m.Fd,T.Ls,J.FY]}),e})()}];let R=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[d.Bz.forChild(N),d.Bz]}),e})();var Y=i(3174);let b=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[v.ez,R,r.UX,h.o7,Z.sL,C.S,Y.HQ,S.j,m.U5,T.PV,J.cS]}),e})()}}]);