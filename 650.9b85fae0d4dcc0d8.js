"use strict";(self.webpackChunkseaskyCMS=self.webpackChunkseaskyCMS||[]).push([[650],{4650:(j,C,a)=>{a.r(C),a.d(C,{ShowcaseListModule:()=>R});var u=a(4755),p=a(1195),l=a(5861),y=a(7489),e=a(2223),M=a(131),x=a(3272),f=a(8397),z=a(1401),L=a(2242),S=a(4247),_=a(4839),d=a(3174),T=a(6377),m=a(8942),A=a(7582),N=a(7579),k=a(2722),h=a(6402),b=a(4780),v=a(8930),w=a(2701),g=a(5030);function O(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"span",1),e.NdJ("click",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.closeTag(o))}),e.qZA()}}const E=["*"];let U=(()=>{class s{constructor(t,n,o,i){this.cdr=t,this.renderer=n,this.elementRef=o,this.directionality=i,this.isPresetColor=!1,this.nzMode="default",this.nzChecked=!1,this.nzOnClose=new e.vpe,this.nzCheckedChange=new e.vpe,this.dir="ltr",this.destroy$=new N.x}updateCheckedStatus(){"checkable"===this.nzMode&&(this.nzChecked=!this.nzChecked,this.nzCheckedChange.emit(this.nzChecked))}closeTag(t){this.nzOnClose.emit(t),t.defaultPrevented||this.renderer.removeChild(this.renderer.parentNode(this.elementRef.nativeElement),this.elementRef.nativeElement)}clearPresetColor(){const t=this.elementRef.nativeElement,n=new RegExp(`(ant-tag-(?:${[...h.uf,...h.Bh].join("|")}))`,"g"),o=t.classList.toString(),i=[];let c=n.exec(o);for(;null!==c;)i.push(c[1]),c=n.exec(o);t.classList.remove(...i)}setPresetColor(){const t=this.elementRef.nativeElement;this.clearPresetColor(),this.isPresetColor=!!this.nzColor&&((0,h.o2)(this.nzColor)||(0,h.M8)(this.nzColor)),this.isPresetColor&&t.classList.add(`ant-tag-${this.nzColor}`)}ngOnInit(){this.directionality.change?.pipe((0,k.R)(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(t){const{nzColor:n}=t;n&&this.setPresetColor()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(e.sBO),e.Y36(e.Qsj),e.Y36(e.SBq),e.Y36(v.Is,8))},s.\u0275cmp=e.Xpm({type:s,selectors:[["nz-tag"]],hostAttrs:[1,"ant-tag"],hostVars:10,hostBindings:function(t,n){1&t&&e.NdJ("click",function(){return n.updateCheckedStatus()}),2&t&&(e.Udp("background-color",n.isPresetColor?"":n.nzColor),e.ekj("ant-tag-has-color",n.nzColor&&!n.isPresetColor)("ant-tag-checkable","checkable"===n.nzMode)("ant-tag-checkable-checked",n.nzChecked)("ant-tag-rtl","rtl"===n.dir))},inputs:{nzMode:"nzMode",nzColor:"nzColor",nzChecked:"nzChecked"},outputs:{nzOnClose:"nzOnClose",nzCheckedChange:"nzCheckedChange"},exportAs:["nzTag"],features:[e.TTD],ngContentSelectors:E,decls:2,vars:1,consts:[["nz-icon","","nzType","close","class","ant-tag-close-icon","tabindex","-1",3,"click",4,"ngIf"],["nz-icon","","nzType","close","tabindex","-1",1,"ant-tag-close-icon",3,"click"]],template:function(t,n){1&t&&(e.F$t(),e.Hsn(0),e.YNc(1,O,1,0,"span",0)),2&t&&(e.xp6(1),e.Q6J("ngIf","closeable"===n.nzMode))},dependencies:[u.O5,w.Ls],encapsulation:2,changeDetection:0}),(0,A.gn)([(0,b.yF)()],s.prototype,"nzChecked",void 0),s})(),F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[v.vT,u.ez,g.u5,w.PV]}),s})();var Z=a(8551);const J=["inputElement"],V=["editElement"];function B(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"nz-tag",19),e.NdJ("click",function(){const i=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.editInput(i))}),e._uU(1),e.qZA()}if(2&s){const t=r.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function I(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"nz-tag",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showInput())}),e._UZ(1,"span",21),e._uU(2," \u65b0\u3057\u3044 + "),e.qZA()}}function H(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"input",22,23),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.inputValue=o)})("keydown.enter",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleInputConfirm())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("ngModel",t.inputValue)}}function D(s,r){1&s&&e._uU(0,"Update")}function P(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"input",24),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.current.name=o)}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("ngModel",t.current.name)}}function Q(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleClose())}),e._uU(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),e.qZA(),e.TgZ(2,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleOk())}),e._uU(3,"OK"),e.qZA()}if(2&s){const t=e.oxw();e.xp6(2),e.Q6J("nzLoading",t.isConfirmLoading)}}function G(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"img",27),e.qZA(),e.TgZ(9,"td")(10,"a",28),e.NdJ("click",function(){const i=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.toEdit(i.id))}),e._uU(11,"Edit"),e.qZA(),e._UZ(12,"nz-divider",29),e.TgZ(13,"a",28),e.NdJ("click",function(){const i=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.delete(i.id))}),e._uU(14,"Delete"),e.qZA()()()}if(2&s){const t=r.$implicit;e.xp6(2),e.Oqu(t.catNm),e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Oqu(t.desc),e.xp6(2),e.Q6J("nzSrc",t.img)}}const Y=[{path:"",component:(()=>{class s{constructor(t,n,o){this.router=t,this.supabase=n,this.message=o,this.isLoading=!1,this.showcases=[],this.tags=[],this.edits=[!1,!1,!1],this.inputVisible=!1,this.inputValue="",this.editVisible=!1,this.isConfirmLoading=!1,this.current={}}ngOnInit(){var t=this;return(0,l.Z)(function*(){yield t.getCate(),t.getList()})()}getName(t){if(!t)return"";{const n=this.tags.findIndex(o=>o.id===t);if(n>-1)return this.tags[n].name}}getCate(){var t=this;return(0,l.Z)(function*(){t.isLoading=!0;const{data:n,error:o}=yield t.supabase.get("showcase_cat");o&&t.message.error(o.message),t.tags=y.sortBy(n,["created_at"])||[],t.isLoading=!1})()}getList(){var t=this;return(0,l.Z)(function*(){t.isLoading=!0;const{data:n,error:o}=yield t.supabase.get("showcase");o&&t.message.error(o.message),t.showcases=n||[],t.showcases.forEach(i=>{i.catNm=t.getName(i.cat)}),t.isLoading=!1})()}toEdit(t){this.router.navigateByUrl(t?`showcase/edit/${t}`:"showcase/add")}delete(t){var n=this;return(0,l.Z)(function*(){const{error:i}=yield n.supabase.delete("showcase",t);i?n.message.error(i.message):(n.message.success("Success"),n.getList())})()}showInput(){this.inputVisible=!0,setTimeout(()=>{this.inputElement?.nativeElement.focus()},10)}editInput(t){this.current=t,this.editVisible=!0}handleInputConfirm(){var t=this;return(0,l.Z)(function*(){if(t.tags.findIndex(i=>i.name===t.inputValue.trim())>-1)return void t.message.error("there exist the same value");const{error:o}=yield t.supabase.upsert("showcase_cat",{name:t.inputValue});o?t.message.error(o.message):(t.message.success("Create category success"),t.getCate()),t.inputValue="",t.inputVisible=!1})()}handleClose(){var t=this;return(0,l.Z)(function*(){const{error:o}=yield t.supabase.delete("showcase_cat",t.current.id);t.editVisible=!1,o?t.message.error(o.message):(t.message.success("Delete Success"),t.tags=t.tags.filter(i=>i!==t.current))})()}showModal(){this.editVisible=!0}handleOk(){var t=this;return(0,l.Z)(function*(){t.isConfirmLoading=!0;const{error:n}=yield t.supabase.upsert("showcase_cat",t.current);t.editVisible=!1,t.isConfirmLoading=!1,n?t.message.error(n.message):(t.message.success("Update  success"),t.getCate())})()}handleCancel(){this.editVisible=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(p.F0),e.Y36(M.T),e.Y36(x.dD))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-showcase-list"]],viewQuery:function(t,n){if(1&t&&(e.Gf(J,5),e.Gf(V,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.inputElement=o.first),e.iGM(o=e.CRH())&&(n.editElement=o.first)}},decls:37,vars:10,consts:[["nzHeader","\u4f8b","nzActive","false"],["src","assets/img/cases.png",2,"width","100%","height","auto"],["nzHeader","\u7523\u696d","nzActive","true"],["nzMode","default",3,"click",4,"ngFor","ngForOf"],["class","editable-tag","nzNoAnimation","",3,"click",4,"ngIf"],["nz-input","","nzSize","small","type","text","style","width: 200px;",3,"ngModel","ngModelChange","keydown.enter",4,"ngIf"],[3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],["nzHeader","\u4e8b\u4f8b\u7d39\u4ecb","nzActive","true"],[1,"header-wrap"],[1,"header-title"],["nz-button","","nzType","primary",1,"header-button",3,"click"],[1,"content-wrap"],[3,"nzData","nzLoading"],["basicTable",""],["nzWidth","124px"],[4,"ngFor","ngForOf"],["nzMode","default",3,"click"],["nzNoAnimation","",1,"editable-tag",3,"click"],["nz-icon","","nzType","plus"],["nz-input","","nzSize","small","type","text",2,"width","200px",3,"ngModel","ngModelChange","keydown.enter"],["inputElement",""],["nz-input","","placeholder","",3,"ngModel","ngModelChange"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"nzLoading","click"],["width","50px","nz-image","",3,"nzSrc"],[3,"click"],["nzType","vertical"]],template:function(t,n){if(1&t&&(e.TgZ(0,"nz-collapse")(1,"nz-collapse-panel",0),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"nz-collapse-panel",2),e.YNc(4,B,2,1,"nz-tag",3),e.YNc(5,I,3,0,"nz-tag",4),e.YNc(6,H,2,1,"input",5),e.TgZ(7,"nz-modal",6),e.NdJ("nzVisibleChange",function(i){return n.editVisible=i})("nzOnCancel",function(){return n.handleCancel()}),e.YNc(8,D,1,0,"ng-template",null,7,e.W1O),e.YNc(10,P,1,1,"ng-template",null,8,e.W1O),e.YNc(12,Q,4,1,"ng-template",null,9,e.W1O),e.qZA()(),e.TgZ(14,"nz-collapse-panel",10)(15,"div",11),e._UZ(16,"div",12),e.TgZ(17,"button",13),e.NdJ("click",function(){return n.toEdit()}),e._uU(18,"Add"),e.qZA()(),e._UZ(19,"nz-divider"),e.TgZ(20,"div",14)(21,"nz-table",15,16)(23,"thead")(24,"tr")(25,"th"),e._uU(26,"Category"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Title"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Description"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"Image"),e.qZA(),e.TgZ(33,"th",17),e._uU(34,"Action"),e.qZA()()(),e.TgZ(35,"tbody"),e.YNc(36,G,15,4,"tr",18),e.qZA()()()()()),2&t){const o=e.MAs(9),i=e.MAs(11),c=e.MAs(13),K=e.MAs(22);e.xp6(4),e.Q6J("ngForOf",n.tags),e.xp6(1),e.Q6J("ngIf",!n.inputVisible),e.xp6(1),e.Q6J("ngIf",n.inputVisible),e.xp6(1),e.Q6J("nzVisible",n.editVisible)("nzTitle",o)("nzContent",i)("nzFooter",c),e.xp6(14),e.Q6J("nzData",n.showcases)("nzLoading",n.isLoading),e.xp6(15),e.Q6J("ngForOf",K.data)}},dependencies:[u.sg,u.O5,f.Zp,z.ix,L.w,S.dQ,_.g,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,T.Ie,m.Zv,m.yH,U,g.Fj,g.JJ,g.On,Z.du],styles:[".header-wrap[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:18px;display:inline-block}.header-wrap[_ngcontent-%COMP%]   .header-button[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]     .uploader>.ant-upload{width:128px;height:128px}"]}),s})()}];let $=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.Bz.forChild(Y),p.Bz]}),s})(),R=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[u.ez,$,f.o7,z.sL,_.S,d.HQ,T.Gb,m.cD,F,g.u5,Z.Qp]}),s})()}}]);